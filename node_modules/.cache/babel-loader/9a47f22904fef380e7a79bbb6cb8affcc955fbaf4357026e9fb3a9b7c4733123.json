{"ast":null,"code":"import _objectSpread from\"/Users/desireelagerquist/Documents/Coding/BCS/projects/thepantryapp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/desireelagerquist/Documents/Coding/BCS/projects/thepantryapp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/desireelagerquist/Documents/Coding/BCS/projects/thepantryapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/desireelagerquist/Documents/Coding/BCS/projects/thepantryapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import axios from'axios';import{Navigate,BrowserRouter as Router,Routes,Route}from'react-router-dom';import Home from'./views/Home.js';import Register from'./views/Register.js';import Profile from'./views/Profile.js';import Recipes from'./views/Recipes.js';import YourRecipes from'./views/YourRecipes.js';import EditProfile from'./views/EditProfile.js';import Pantry from'./views/Pantry.js';import NavBar from'./components/NavBar.js';import{URL}from'./config.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoggedIn=_useState2[0],setIsLoggedIn=_useState2[1];var _useState3=useState({pantry:[]}),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var token=localStorage.getItem('token');useEffect(function(){var verify_token=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;if(token){_context.next=3;break;}return _context.abrupt(\"return\",logout());case 3:axios.defaults.headers.common['Authorization']=token;_context.next=6;return axios.post(\"\".concat(URL,\"/user/verify_token\"));case 6:response=_context.sent;console.log('verify: ',response.data.user);return _context.abrupt(\"return\",response.data.ok?(login(token,response.data.user),setUser(response.data.user)):logout());case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function verify_token(){return _ref.apply(this,arguments);};}();verify_token();},[]);var login=function login(token,userData){localStorage.setItem('token',token);setIsLoggedIn(true);//send user data so on login user information is available\nsetUser(userData);};var logout=function logout(){localStorage.removeItem('token');setIsLoggedIn(false);};var updateUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(key,value){var copy,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;copy=_objectSpread({},user);copy[key]=value;_context2.next=5;return axios.post(\"\".concat(URL,\"/user/update\"),{copy:copy});case 5:res=_context2.sent;setUser(res.data.user);console.log('update: ',res.data.user.pantry);_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 13:case\"end\":return _context2.stop();}},_callee2,null,[[0,10]]);}));return function updateUser(_x,_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(NavBar,{isLoggedIn:isLoggedIn,logout:logout,login:login}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:!isLoggedIn?/*#__PURE__*/_jsx(Register,{login:login}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/recipes\",element:isLoggedIn?/*#__PURE__*/_jsx(Navigate,{to:\"/yourrecipes\"}):/*#__PURE__*/_jsx(Recipes,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:isLoggedIn?/*#__PURE__*/_jsx(Profile,{user:user}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/pantry\",element:isLoggedIn?/*#__PURE__*/_jsx(Pantry,{pantry:user===null||user===void 0?void 0:user.pantry,updateUser:updateUser}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/yourrecipes\",element:isLoggedIn?/*#__PURE__*/_jsx(YourRecipes,{user:user,isLoggedIn:isLoggedIn,updateUser:updateUser}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})}),/*#__PURE__*/_jsx(Route,{path:\"/editprofile\",element:isLoggedIn?/*#__PURE__*/_jsx(EditProfile,{updateUser:updateUser,isLoggedIn:isLoggedIn,user:user,logout:logout}):/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})]}),/*#__PURE__*/_jsx(\"footer\",{children:\"Serving your tastebuds since February 2022 | Contact: Thepantryapp@gmail.com\"})]});}","map":{"version":3,"names":["React","useEffect","useState","axios","Navigate","BrowserRouter","Router","Routes","Route","Home","Register","Profile","Recipes","YourRecipes","EditProfile","Pantry","NavBar","URL","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","isLoggedIn","setIsLoggedIn","_useState3","pantry","_useState4","user","setUser","token","localStorage","getItem","verify_token","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","abrupt","logout","defaults","headers","common","post","concat","sent","console","log","data","ok","login","t0","stop","apply","arguments","userData","setItem","removeItem","updateUser","_ref2","_callee2","key","value","copy","res","_callee2$","_context2","_objectSpread","error","_x","_x2","children","exact","path","element","to"],"sources":["/Users/desireelagerquist/Documents/Coding/BCS/projects/thepantryapp/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { Navigate, BrowserRouter as Router, Routes, Route } from 'react-router-dom'\nimport Home from './views/Home.js'\nimport Register from './views/Register.js'\nimport Profile from './views/Profile.js'\nimport Recipes from './views/Recipes.js'\nimport YourRecipes from './views/YourRecipes.js'\nimport EditProfile from './views/EditProfile.js'\nimport Pantry from './views/Pantry.js'\nimport NavBar from './components/NavBar.js'\n\nimport { URL } from './config.js'\n\nexport default function App() {\n\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [user, setUser] = useState({\n    pantry: []\n  })\n  let token = localStorage.getItem('token');\n\n  useEffect(\n    () => {\n      const verify_token = async () => {\n        try {\n          // token = localStorage.getItem('token')\n          if (!token) {\n            return logout()\n          }\n          axios.defaults.headers.common['Authorization'] = token;\n          const response = await axios.post(`${URL}/user/verify_token`);\n          console.log('verify: ', response.data.user)\n          \n          return response.data.ok ? (login(token, response.data.user), setUser(response.data.user)) : logout();\n        } catch (err) {\n          console.log(err);\n        }\n      };\n      verify_token();\n    },\n    []\n  );\n\n  const login = (token,userData) => {\n    localStorage.setItem('token', token);\n    setIsLoggedIn(true);\n    //send user data so on login user information is available\n    setUser(userData)\n  };\n\n  const logout = () => {\n    localStorage.removeItem('token');\n    setIsLoggedIn(false);\n  };\n\n  const updateUser = async (key, value) => {\n    try {\n      const copy = { ...user }\n      copy[key] = value\n      const res = await axios.post(`${URL}/user/update`, { copy })\n      setUser(res.data.user)\n      console.log('update: ', res.data.user.pantry);\n    } catch (err) {\n      console.error(err)\n    }\n  }\n\n  return <div>\n\n    <Router>\n      <NavBar isLoggedIn={isLoggedIn} logout={logout} login={login} />\n      <Routes>\n        <Route exact path='/' element={<Home />} />\n        <Route path='/register' element={!isLoggedIn ? <Register login={login} /> : <Navigate to='/' />} />\n        <Route path='/recipes' element={isLoggedIn ? <Navigate to='/yourrecipes' /> : <Recipes />} />\n        <Route path='/profile' element={isLoggedIn ? <Profile user={user}/> : <Navigate to='/' />} />\n        <Route path='/pantry' element={isLoggedIn ? <Pantry pantry={user?.pantry} updateUser={updateUser} /> : <Navigate to='/' />} />\n        <Route path='/yourrecipes' element={isLoggedIn ? <YourRecipes user={user} isLoggedIn={isLoggedIn} updateUser={updateUser} /> : <Navigate to='/' />} />\n        <Route path='/editprofile' element={isLoggedIn ? <EditProfile updateUser={updateUser} isLoggedIn={isLoggedIn} user={user} logout={logout}/> : <Navigate to='/' />} />\n      </Routes>\n    </Router>\n\n    <footer>\n      Serving your tastebuds since February 2022 | Contact: Thepantryapp@gmail.com\n    </footer>\n  </div>\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}